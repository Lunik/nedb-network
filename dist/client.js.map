{"version":3,"sources":["../client.js"],"names":["Object","defineProperty","exports","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_request","require","_request2","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","TypeError","Client","database","host","port","token","db","find","query","cb","get","url","headers","Authorization","qs","err","res","body","statusCode","console","error","JSON","parse","data","insert","post","form","update","options","__database","remove"],"mappings":"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","file":"client.js","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _request = require('request');\n\nvar _request2 = _interopRequireDefault(_request);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Client = function () {\n  function Client(database, host, port, token) {\n    _classCallCheck(this, Client);\n\n    this.db = database;\n    this.host = host;\n    this.port = port;\n    this.token = token;\n  }\n\n  _createClass(Client, [{\n    key: 'find',\n    value: function find(query, cb) {\n      cb = cb || function () {};\n\n      query['__database'] = this.db;\n      _request2.default.get({\n        url: 'http://' + this.host + ':' + this.port + '/api/find',\n        headers: {\n          Authorization: this.token\n        },\n        qs: query\n      }, function (err, res, body) {\n        if (err || res.statusCode === 403) {\n          if (res && res.statusCode === 403) {\n            console.error('Unauthorized 403');\n            cb(null, []);\n          } else {\n            cb(err, []);\n          }\n        } else {\n          try {\n            body = JSON.parse(body);\n            if (body.err) {\n              cb(body.err, []);\n            } else {\n              cb(null, body.data);\n            }\n          } catch (err) {\n            cb(err, []);\n          }\n        }\n      });\n    }\n  }, {\n    key: 'insert',\n    value: function insert(data, cb) {\n      cb = cb || function () {};\n\n      data['__database'] = this.db;\n      _request2.default.post({\n        url: 'http://' + this.host + ':' + this.port + '/api/insert',\n        headers: {\n          Authorization: this.token\n        },\n        form: data\n      }, function (err, res, body) {\n        if (err || res.statusCode === 403) {\n          if (res && res.statusCode === 403) {\n            cb('Database request unauthorized 403');\n          } else {\n            cb(err);\n          }\n        } else {\n          try {\n            body = JSON.parse(body);\n            if (body.err) {\n              cb(body.err);\n            } else {\n              cb(null);\n            }\n          } catch (err) {\n            cb(err);\n          }\n        }\n      });\n    }\n  }, {\n    key: 'update',\n    value: function update(query, data, options, cb) {\n      cb = cb || function () {};\n\n      _request2.default.post({\n        url: 'http://' + this.host + ':' + this.port + '/api/update',\n        headers: {\n          Authorization: this.token\n        },\n        form: {\n          query: query,\n          data: data,\n          options: options,\n          __database: this.db\n        }\n      }, function (err, res, body) {\n        if (err || res.statusCode === 403) {\n          if (res && res.statusCode === 403) {\n            cb('Database request unauthorized 403');\n          } else {\n            cb(err);\n          }\n        } else {\n          try {\n            body = JSON.parse(body);\n            if (body.err) {\n              cb(body.err);\n            } else {\n              cb(null);\n            }\n          } catch (err) {\n            cb(err);\n          }\n        }\n      });\n    }\n  }, {\n    key: 'remove',\n    value: function remove(query, options, cb) {\n      cb = cb || function () {};\n\n      _request2.default.post({\n        url: 'http://' + this.host + ':' + this.port + '/api/remove',\n        headers: {\n          Authorization: this.token\n        },\n        form: {\n          query: query,\n          options: options,\n          __database: this.db\n        }\n      }, function (err, res, body) {\n        if (err || res.statusCode === 403) {\n          if (res && res.statusCode === 403) {\n            cb('Database request unauthorized 403');\n          } else {\n            cb(err);\n          }\n        } else {\n          try {\n            body = JSON.parse(body);\n            if (body.err) {\n              cb(body.err);\n            } else {\n              cb(null);\n            }\n          } catch (err) {\n            cb(err);\n          }\n        }\n      });\n    }\n  }]);\n\n  return Client;\n}();\n\nexports.default = Client;"]}